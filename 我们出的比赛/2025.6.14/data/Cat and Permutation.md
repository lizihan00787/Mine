# Cat and Permutation

## 题目描述

有一天，无聊的猫猫们想出了一个新游戏。由一只睿智的猫给出了一个长度为 $n$ 的排列，它们想知道这个排列是不是一个好排列。

一个排列是好的，当且仅当对于所有正整数 $m$ 都满足所有长度为  $2m+1$ 的子串的**中位数**不在第 $m+1$ 个。

但是，这个给出排列太长了，小猫只记住了一些位上的数。所以它会给你一个一些数被替换成 $−1$ 的排列，你需要将 $−1$ 填入所有可能的值后，统计好的排列数量。

答案对 $10^9+7$ 取模。

## 输入格式

第一行一个整数  $ t $ ( $ 1 \le t \le 10^4 $ )，表示 $t$ 组询问。

接下来每组，第一行一个整数  $ n $ $ (2 \le n \le 10^6) $ 。

第二行 $n$ 个整数，表示一个长为 $n$ 的排列。

## 输出格式

输出 $t$ 行，每行一个整数表示可能的好的排列数量。

## 输入输出样例 

### 输入 

```
5
2
-1 -1
3
-1 -1 -1
4
1 2 3 4
6
-1 -1 3 4 -1 -1
8
-1 -1 -1 -1 -1 -1 -1 -1
```

### 输出 

```
2
4
0
1
316
```

## 数据范围

对于 $10\%$ 的数据，保证排列中的数只有 $-1$ 。

对于另外 $10\%$ 的数据，保证 $\sum n<8 $ 。

对于 $50\%$ 的数据，保证 $\sum n^2\le 10^6$ 。

对于 $100\%$ 的数据，保证 $\sum n\le 10^6$ 。

